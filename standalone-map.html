<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALICE Data Map - Standalone Version</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        #map {
            height: 100vh;
            width: 100%;
        }
        
        .info-box {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 350px;
        }
        
        h2 {
            margin: 0 0 15px 0;
            color: #333;
        }
        
        .search-box {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        
        .results {
            max-height: 400px;
            overflow-y: auto;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }
        
        .location-item {
            padding: 10px;
            margin: 5px 0;
            background: #f5f5f5;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .location-item:hover {
            background: #e0e0e0;
        }
        
        .location-name {
            font-weight: bold;
            color: #0066cc;
        }
        
        .location-stats {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .rate-high {
            color: #d32f2f;
            font-weight: bold;
        }
        
        .rate-medium {
            color: #f57c00;
            font-weight: bold;
        }
        
        .rate-low {
            color: #388e3c;
            font-weight: bold;
        }
        
        .legend {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 50%;
            border: 1px solid #999;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="info-box">
        <h2>ALICE County Data</h2>
        <input type="text" class="search-box" id="searchInput" placeholder="Search counties..." onkeyup="filterLocations()">
        
        <div id="results" class="results"></div>
        
        <div class="legend">
            <strong>Combined ALICE + Poverty Rate</strong>
            <div class="legend-item">
                <div class="legend-color" style="background: #2ecc71;"></div>
                <span>&lt; 35% - Low Impact</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #f39c12;"></div>
                <span>35-45% - Moderate</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #e74c3c;"></div>
                <span>&gt; 45% - High Impact</span>
            </div>
        </div>
    </div>
    
    <script>
        // Embedded sample of ALICE data - top counties from each state
        const aliceData = [
            // Texas
            { name: "Harris County, TX", state: "Texas", lat: 29.7604, lng: -95.3698, poverty: 14.1, alice: 31.2, combined: 45.3, households: 1600000 },
            { name: "Dallas County, TX", state: "Texas", lat: 32.7767, lng: -96.7970, poverty: 15.2, alice: 30.8, combined: 46.0, households: 950000 },
            { name: "Bexar County, TX", state: "Texas", lat: 29.4241, lng: -98.4936, poverty: 14.8, alice: 32.1, combined: 46.9, households: 720000 },
            { name: "Travis County, TX", state: "Texas", lat: 30.2672, lng: -97.7431, poverty: 10.2, alice: 28.5, combined: 38.7, households: 490000 },
            { name: "Hidalgo County, TX", state: "Texas", lat: 26.1008, lng: -98.2630, poverty: 28.9, alice: 34.2, combined: 63.1, households: 280000 },
            
            // Florida
            { name: "Miami-Dade County, FL", state: "Florida", lat: 25.7617, lng: -80.1918, poverty: 16.3, alice: 37.4, combined: 53.7, households: 950000 },
            { name: "Broward County, FL", state: "Florida", lat: 26.1224, lng: -80.1373, poverty: 13.2, alice: 35.8, combined: 49.0, households: 750000 },
            { name: "Palm Beach County, FL", state: "Florida", lat: 26.7056, lng: -80.0364, poverty: 12.1, alice: 34.2, combined: 46.3, households: 580000 },
            { name: "Hillsborough County, FL", state: "Florida", lat: 27.9904, lng: -82.3018, poverty: 13.8, alice: 34.9, combined: 48.7, households: 550000 },
            { name: "Orange County, FL", state: "Florida", lat: 28.5383, lng: -81.3792, poverty: 13.2, alice: 36.5, combined: 49.7, households: 520000 },
            
            // California
            { name: "Los Angeles County, CA", state: "California", lat: 34.0522, lng: -118.2437, poverty: 14.9, alice: 33.1, combined: 48.0, households: 3400000 },
            { name: "San Diego County, CA", state: "California", lat: 32.7157, lng: -117.1611, poverty: 11.8, alice: 29.7, combined: 41.5, households: 1150000 },
            { name: "Orange County, CA", state: "California", lat: 33.7175, lng: -117.8311, poverty: 10.2, alice: 31.4, combined: 41.6, households: 1050000 },
            { name: "Riverside County, CA", state: "California", lat: 33.7462, lng: -116.3943, poverty: 13.1, alice: 32.8, combined: 45.9, households: 780000 },
            { name: "San Bernardino County, CA", state: "California", lat: 34.1083, lng: -117.2898, poverty: 15.3, alice: 33.7, combined: 49.0, households: 680000 },
            
            // New York
            { name: "New York County, NY", state: "New York", lat: 40.7831, lng: -73.9712, poverty: 14.7, alice: 35.8, combined: 50.5, households: 760000 },
            { name: "Kings County, NY", state: "New York", lat: 40.6782, lng: -73.9442, poverty: 18.9, alice: 32.6, combined: 51.5, households: 960000 },
            { name: "Queens County, NY", state: "New York", lat: 40.7282, lng: -73.7949, poverty: 11.6, alice: 36.2, combined: 47.8, households: 820000 },
            { name: "Bronx County, NY", state: "New York", lat: 40.8448, lng: -73.8648, poverty: 26.6, alice: 30.9, combined: 57.5, households: 520000 },
            { name: "Suffolk County, NY", state: "New York", lat: 40.8832, lng: -72.8012, poverty: 6.2, alice: 30.5, combined: 36.7, households: 510000 },
            
            // Illinois
            { name: "Cook County, IL", state: "Illinois", lat: 41.8781, lng: -87.6298, poverty: 13.5, alice: 28.9, combined: 42.4, households: 2100000 },
            { name: "DuPage County, IL", state: "Illinois", lat: 41.9047, lng: -88.0787, poverty: 6.4, alice: 22.7, combined: 29.1, households: 350000 },
            { name: "Lake County, IL", state: "Illinois", lat: 42.3256, lng: -87.8882, poverty: 8.7, alice: 24.3, combined: 33.0, households: 260000 },
            { name: "Will County, IL", state: "Illinois", lat: 41.4477, lng: -87.9819, poverty: 6.8, alice: 23.9, combined: 30.7, households: 240000 },
            
            // Pennsylvania
            { name: "Philadelphia County, PA", state: "Pennsylvania", lat: 39.9526, lng: -75.1652, poverty: 22.3, alice: 27.7, combined: 50.0, households: 610000 },
            { name: "Allegheny County, PA", state: "Pennsylvania", lat: 40.4406, lng: -79.9959, poverty: 11.1, alice: 26.4, combined: 37.5, households: 540000 },
            { name: "Montgomery County, PA", state: "Pennsylvania", lat: 40.2115, lng: -75.3685, poverty: 6.2, alice: 22.3, combined: 28.5, households: 320000 },
            
            // Ohio
            { name: "Cuyahoga County, OH", state: "Ohio", lat: 41.4993, lng: -81.6944, poverty: 16.1, alice: 27.8, combined: 43.9, households: 540000 },
            { name: "Franklin County, OH", state: "Ohio", lat: 39.9612, lng: -82.9988, poverty: 13.9, alice: 27.2, combined: 41.1, households: 520000 },
            { name: "Hamilton County, OH", state: "Ohio", lat: 39.1031, lng: -84.5120, poverty: 14.6, alice: 26.9, combined: 41.5, households: 350000 },
            
            // Michigan
            { name: "Wayne County, MI", state: "Michigan", lat: 42.2844, lng: -83.2437, poverty: 21.7, alice: 26.3, combined: 48.0, households: 700000 },
            { name: "Oakland County, MI", state: "Michigan", lat: 42.6389, lng: -83.4187, poverty: 8.2, alice: 25.1, combined: 33.3, households: 520000 },
            { name: "Macomb County, MI", state: "Michigan", lat: 42.6706, lng: -82.9093, poverty: 10.4, alice: 28.7, combined: 39.1, households: 350000 },
            
            // Georgia
            { name: "Fulton County, GA", state: "Georgia", lat: 33.7490, lng: -84.3880, poverty: 13.2, alice: 28.6, combined: 41.8, households: 430000 },
            { name: "Gwinnett County, GA", state: "Georgia", lat: 33.9604, lng: -84.0379, poverty: 10.1, alice: 29.3, combined: 39.4, households: 320000 },
            { name: "DeKalb County, GA", state: "Georgia", lat: 33.7956, lng: -84.2279, poverty: 15.3, alice: 31.2, combined: 46.5, households: 290000 },
            
            // North Carolina
            { name: "Mecklenburg County, NC", state: "North Carolina", lat: 35.2271, lng: -80.8431, poverty: 11.0, alice: 29.5, combined: 40.5, households: 440000 },
            { name: "Wake County, NC", state: "North Carolina", lat: 35.7796, lng: -78.6382, poverty: 8.7, alice: 25.8, combined: 34.5, households: 420000 },
            
            // Virginia
            { name: "Fairfax County, VA", state: "Virginia", lat: 38.8462, lng: -77.3064, poverty: 5.6, alice: 23.1, combined: 28.7, households: 410000 },
            { name: "Prince William County, VA", state: "Virginia", lat: 38.7849, lng: -77.6147, poverty: 6.3, alice: 26.2, combined: 32.5, households: 160000 },
            
            // Massachusetts
            { name: "Middlesex County, MA", state: "Massachusetts", lat: 42.4672, lng: -71.2874, poverty: 8.3, alice: 26.8, combined: 35.1, households: 610000 },
            { name: "Suffolk County, MA", state: "Massachusetts", lat: 42.3601, lng: -71.0589, poverty: 17.8, alice: 29.2, combined: 47.0, households: 310000 },
            
            // Washington
            { name: "King County, WA", state: "Washington", lat: 47.5480, lng: -121.9836, poverty: 8.5, alice: 24.7, combined: 33.2, households: 920000 },
            { name: "Pierce County, WA", state: "Washington", lat: 47.0676, lng: -122.1295, poverty: 10.7, alice: 28.3, combined: 39.0, households: 330000 },
            
            // Arizona
            { name: "Maricopa County, AZ", state: "Arizona", lat: 33.4484, lng: -112.0740, poverty: 12.8, alice: 30.6, combined: 43.4, households: 1700000 },
            { name: "Pima County, AZ", state: "Arizona", lat: 32.0202, lng: -111.5019, poverty: 15.4, alice: 31.2, combined: 46.6, households: 420000 },
            
            // Tennessee
            { name: "Shelby County, TN", state: "Tennessee", lat: 35.1495, lng: -90.0490, poverty: 18.4, alice: 30.2, combined: 48.6, households: 360000 },
            { name: "Davidson County, TN", state: "Tennessee", lat: 36.1627, lng: -86.7816, poverty: 13.1, alice: 29.8, combined: 42.9, households: 290000 },
            
            // Indiana
            { name: "Marion County, IN", state: "Indiana", lat: 39.7684, lng: -86.1581, poverty: 16.8, alice: 28.9, combined: 45.7, households: 380000 },
            { name: "Lake County, IN", state: "Indiana", lat: 41.4753, lng: -87.4470, poverty: 15.9, alice: 27.6, combined: 43.5, households: 190000 },
            
            // Missouri
            { name: "St. Louis County, MO", state: "Missouri", lat: 38.6103, lng: -90.4125, poverty: 9.6, alice: 26.8, combined: 36.4, households: 420000 },
            { name: "Jackson County, MO", state: "Missouri", lat: 39.0168, lng: -94.3635, poverty: 14.4, alice: 28.7, combined: 43.1, households: 280000 },
            
            // Maryland
            { name: "Montgomery County, MD", state: "Maryland", lat: 39.1416, lng: -77.2015, poverty: 6.1, alice: 23.7, combined: 29.8, households: 380000 },
            { name: "Prince George's County, MD", state: "Maryland", lat: 38.8275, lng: -76.8493, poverty: 8.3, alice: 31.4, combined: 39.7, households: 330000 },
            { name: "Baltimore County, MD", state: "Maryland", lat: 39.4455, lng: -76.6197, poverty: 8.9, alice: 27.2, combined: 36.1, households: 330000 },
            
            // Wisconsin
            { name: "Milwaukee County, WI", state: "Wisconsin", lat: 43.0389, lng: -87.9065, poverty: 16.4, alice: 26.8, combined: 43.2, households: 400000 },
            { name: "Dane County, WI", state: "Wisconsin", lat: 43.0731, lng: -89.4012, poverty: 8.7, alice: 22.3, combined: 31.0, households: 230000 },
            
            // Colorado
            { name: "Denver County, CO", state: "Colorado", lat: 39.7392, lng: -104.9903, poverty: 11.3, alice: 27.9, combined: 39.2, households: 310000 },
            { name: "Jefferson County, CO", state: "Colorado", lat: 39.5743, lng: -105.3566, poverty: 6.9, alice: 24.8, combined: 31.7, households: 240000 },
            
            // Minnesota
            { name: "Hennepin County, MN", state: "Minnesota", lat: 44.9778, lng: -93.2650, poverty: 9.7, alice: 23.4, combined: 33.1, households: 510000 },
            { name: "Ramsey County, MN", state: "Minnesota", lat: 45.0153, lng: -93.0156, poverty: 12.8, alice: 25.1, combined: 37.9, households: 220000 },
            
            // Oregon
            { name: "Multnomah County, OR", state: "Oregon", lat: 45.5152, lng: -122.6784, poverty: 12.4, alice: 28.3, combined: 40.7, households: 340000 },
            { name: "Washington County, OR", state: "Oregon", lat: 45.5470, lng: -123.1097, poverty: 8.2, alice: 26.5, combined: 34.7, households: 230000 },
            
            // Connecticut
            { name: "Hartford County, CT", state: "Connecticut", lat: 41.7658, lng: -72.6734, poverty: 10.5, alice: 29.3, combined: 39.8, households: 360000 },
            { name: "New Haven County, CT", state: "Connecticut", lat: 41.3507, lng: -72.8999, poverty: 11.4, alice: 30.6, combined: 42.0, households: 340000 },
            
            // Louisiana
            { name: "Orleans Parish, LA", state: "Louisiana", lat: 29.9511, lng: -90.0715, poverty: 21.9, alice: 30.1, combined: 52.0, households: 160000 },
            { name: "Jefferson Parish, LA", state: "Louisiana", lat: 29.8958, lng: -90.1095, poverty: 14.8, alice: 32.3, combined: 47.1, households: 180000 }
        ];
        
        let map;
        let markers = [];
        
        function initMap() {
            // Create map centered on USA
            map = L.map('map').setView([39.8283, -98.5795], 4);
            
            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(map);
            
            // Add all markers
            aliceData.forEach(location => {
                const color = getColor(location.combined);
                
                const marker = L.circleMarker([location.lat, location.lng], {
                    radius: 10,
                    fillColor: color,
                    color: '#fff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.8
                });
                
                marker.bindPopup(`
                    <strong>${location.name}</strong><br>
                    Poverty Rate: ${location.poverty}%<br>
                    ALICE Rate: ${location.alice}%<br>
                    <strong>Combined: ${location.combined}%</strong><br>
                    Households: ${location.households.toLocaleString()}
                `);
                
                marker.addTo(map);
                markers.push({marker: marker, data: location});
            });
            
            // Display all locations in list
            displayLocations(aliceData);
        }
        
        function getColor(combinedRate) {
            return combinedRate > 45 ? '#e74c3c' :
                   combinedRate > 35 ? '#f39c12' :
                   '#2ecc71';
        }
        
        function displayLocations(locations) {
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.innerHTML = locations.map(loc => {
                const rateClass = loc.combined > 45 ? 'rate-high' : 
                                 loc.combined > 35 ? 'rate-medium' : 'rate-low';
                
                return `
                    <div class="location-item" onclick="focusLocation(${loc.lat}, ${loc.lng})">
                        <div class="location-name">${loc.name}</div>
                        <div class="location-stats">
                            Poverty: ${loc.poverty}% | ALICE: ${loc.alice}%<br>
                            <span class="${rateClass}">Combined: ${loc.combined}%</span><br>
                            Households: ${loc.households.toLocaleString()}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function focusLocation(lat, lng) {
            map.setView([lat, lng], 10);
            
            // Find and open the popup
            markers.forEach(m => {
                if (Math.abs(m.data.lat - lat) < 0.001 && Math.abs(m.data.lng - lng) < 0.001) {
                    m.marker.openPopup();
                }
            });
        }
        
        function filterLocations() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            const filtered = searchTerm ? 
                aliceData.filter(loc => 
                    loc.name.toLowerCase().includes(searchTerm) ||
                    loc.state.toLowerCase().includes(searchTerm)
                ) : aliceData;
            
            displayLocations(filtered);
        }
        
        // Initialize map when page loads
        window.onload = initMap;
    </script>
</body>
</html>